{% extends 'components/charts/_base_chart.html' %}

{% block body_content %}
<div id="{{ data.chart_id }}" style="width: 100%; height: 100%;"></div>
<script type="text/javascript">
    function deepMerge(target, source) {
        for (const key in source) {
            if (source.hasOwnProperty(key)) {
                if (source[key] && typeof source[key] === 'object' && !Array.isArray(source[key])) {
                    if (!target[key]) {
                        Object.assign(target, { [key]: {} });
                    }
                    deepMerge(target[key], source[key]);
                } else if (Array.isArray(source[key]) && Array.isArray(target[key])) {
                    target[key] = target[key].map((item, i) =>
                        (source[key][i] && typeof source[key][i] === 'object')
                            ? deepMerge(item, source[key][i])
                            : source[key][i] || item
                    );
                } else {
                    Object.assign(target, { [key]: source[key] });
                }
            }
        }
        return target;
    }
    var option = deepMerge({{ data.build_option() | dump_json | safe }}, {% include './style.json' %});
</script>
{% endblock %}
